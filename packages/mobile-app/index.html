<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="color-scheme" content="light dark">
    <style>
      :root {
        color-scheme: light dark;
      }
      body {
        margin: 0;
        background-color: #fafbfc;
        color: #1a1a1a;
      }
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #0a0f1a;
          color: #e8e9ed;
        }
      }
    </style>
    <script>
      (function(){var t=localStorage.getItem('yektayar-theme');if(t==='dark'){document.body.style.backgroundColor='#0a0f1a';document.body.style.color='#e8e9ed';}else if(t==='light'){document.body.style.backgroundColor='#fafbfc';document.body.style.color='#1a1a1a';}})();
    </script>
    <!-- Light mode icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" media="(prefers-color-scheme: light)" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" media="(prefers-color-scheme: light)" />
    <link rel="icon" type="image/svg+xml" href="/icon.svg" media="(prefers-color-scheme: light)" />
    <!-- Dark mode icons (default) -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32-dark.png" media="(prefers-color-scheme: dark)" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16-dark.png" media="(prefers-color-scheme: dark)" />
    <link rel="icon" type="image/svg+xml" href="/icon-dark.svg" media="(prefers-color-scheme: dark)" />
    <!-- Default fallback (dark variant) -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32-dark.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192x192-dark.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="theme-color" content="#d4a43e" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#01183a" media="(prefers-color-scheme: dark)" />

    <title>یکتایار - پلتفرم مراقبت سلامت روان</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  </head>
  <body>
    <div id="app"></div>
    <script>
      // Global error handler to prevent white screen
      window.addEventListener('error', function(event) {
        console.error('Global error caught:', event.error || event.message);
        showErrorScreen(
          'Application Error',
          'The application encountered an error and cannot start.',
          event.error ? (event.error.stack || event.error.message) : event.message
        );
      });

      window.addEventListener('unhandledrejection', function(event) {
        console.error('Unhandled promise rejection:', event.reason);
        showErrorScreen(
          'Promise Rejection',
          'The application encountered an error and cannot start.',
          event.reason ? (event.reason.stack || event.reason.message || String(event.reason)) : 'Unknown error'
        );
      });

      function showErrorScreen(title, message, details) {
        var app = document.getElementById('app');
        if (!app) return;
        
        app.innerHTML = '<div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #f8f9fa; display: flex; align-items: center; justify-content: center; z-index: 9999;">' +
          '<div style="display: flex; flex-direction: column; align-items: center; text-align: center; padding: 2rem; max-width: 600px;">' +
          '<div style="font-size: 5rem; margin-bottom: 1.5rem;">❌</div>' +
          '<h1 style="font-size: 1.75rem; font-weight: bold; color: #dc3545; margin-bottom: 1rem;">' + escapeHtml(title) + '</h1>' +
          '<p style="font-size: 1.125rem; color: #495057; margin-bottom: 1.5rem; line-height: 1.6;">' + escapeHtml(message) + '</p>' +
          '<div style="background: #fff; border: 1px solid #dee2e6; border-radius: 0.5rem; padding: 1rem; width: 100%;">' +
          '<p style="font-size: 0.875rem; color: #6c757d; margin: 0; font-family: monospace; word-break: break-word; text-align: left;">' + escapeHtml(details) + '</p>' +
          '</div>' +
          '</div>' +
          '</div>';
      }

      function escapeHtml(text) {
        var div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }
    </script>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
